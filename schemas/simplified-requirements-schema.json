{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://req-mindmap.example.com/schemas/simplified-requirements-schema.json",
  "title": "要件定義マインドマップ - 簡易スキーマ",
  "description": "実用性を重視した必要十分な要件定義スキーマ",
  "type": "object",
  "required": ["version", "title", "templateType", "core", "metadata"],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+$",
      "description": "スキーマバージョン"
    },
    "title": {
      "type": "string",
      "minLength": 1,
      "description": "マインドマップのタイトル"
    },
    "description": {
      "type": "string",
      "description": "マインドマップの説明"
    },
    "templateType": {
      "type": "string",
      "const": "simplified-requirements",
      "description": "テンプレート種別"
    },
    "core": {
      "$ref": "#/definitions/CoreRequirements"
    },
    "stakeholders": {
      "$ref": "#/definitions/Stakeholders"
    },
    "qualityTargets": {
      "$ref": "#/definitions/QualityTargets"
    },
    "metadata": {
      "$ref": "#/definitions/Metadata"
    }
  },

  "definitions": {
    "RequirementLevel": {
      "type": "string",
      "enum": ["business", "user", "system"],
      "description": "要件レベル: business=ビジネス要件, user=ユーザー要件, system=システム要件"
    },

    "Priority": {
      "type": "string",
      "enum": ["must", "should", "could", "wont"],
      "description": "MoSCoW優先度"
    },

    "Status": {
      "type": "string", 
      "enum": ["draft", "review", "approved", "implemented", "verified"],
      "description": "要件ステータス"
    },

    "RequirementNode": {
      "type": "object",
      "required": ["id", "title", "level", "priority", "status", "description"],
      "properties": {
        "id": { "type": "string" },
        "title": { "type": "string", "minLength": 1 },
        "description": { "type": "string" },
        "level": { "$ref": "#/definitions/RequirementLevel" },
        "priority": { "$ref": "#/definitions/Priority" },
        "status": { "$ref": "#/definitions/Status" },
        "category": { "type": "string" },
        "owner": { "type": "string" },
        "effort": {
          "type": "object",
          "properties": {
            "size": { "type": "string", "enum": ["XS", "S", "M", "L", "XL"] },
            "hours": { "type": "number", "minimum": 0 }
          }
        },
        "acceptanceCriteria": {
          "type": "array",
          "items": { "type": "string" }
        },
        "dependencies": {
          "type": "array",
          "items": { "type": "string" }
        },
        "tags": {
          "type": "array",
          "items": { "type": "string" }
        },
        "notes": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" },
        "updatedAt": { "type": "string", "format": "date-time" },
        "children": {
          "type": "array",
          "items": { "$ref": "#/definitions/RequirementNode" }
        }
      }
    },

    "CoreRequirements": {
      "type": "object",
      "required": ["businessGoals", "userRequirements", "systemRequirements"],
      "properties": {
        "businessGoals": {
          "type": "array",
          "items": { "$ref": "#/definitions/RequirementNode" },
          "description": "ビジネス目標・価値"
        },
        "userRequirements": {
          "type": "array", 
          "items": { "$ref": "#/definitions/RequirementNode" },
          "description": "ユーザー要件・機能要求"
        },
        "systemRequirements": {
          "type": "array",
          "items": { "$ref": "#/definitions/RequirementNode" },
          "description": "システム要件・技術要求"
        }
      }
    },

    "Stakeholder": {
      "type": "object",
      "required": ["id", "name", "role", "influence", "interest"],
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "role": { "type": "string" },
        "organization": { "type": "string" },
        "influence": { "type": "string", "enum": ["high", "medium", "low"] },
        "interest": { "type": "string", "enum": ["high", "medium", "low"] },
        "email": { "type": "string", "format": "email" },
        "responsibilities": {
          "type": "array",
          "items": { "type": "string" }
        },
        "notes": { "type": "string" }
      }
    },

    "Stakeholders": {
      "type": "object",
      "additionalProperties": { "$ref": "#/definitions/Stakeholder" }
    },

    "QualityTarget": {
      "type": "object",
      "required": ["name", "target", "priority"],
      "properties": {
        "name": { "type": "string" },
        "category": {
          "type": "string",
          "enum": ["performance", "usability", "reliability", "security", "maintainability"]
        },
        "target": { "type": "string" },
        "measurable": { "type": "boolean", "default": true },
        "priority": { "$ref": "#/definitions/Priority" },
        "testMethod": { "type": "string" }
      }
    },

    "QualityTargets": {
      "type": "array",
      "items": { "$ref": "#/definitions/QualityTarget" }
    },

    "Metadata": {
      "type": "object",
      "required": ["createdAt", "updatedAt", "version"],
      "properties": {
        "createdAt": { "type": "string", "format": "date-time" },
        "updatedAt": { "type": "string", "format": "date-time" },
        "version": { "type": "string" },
        "authors": {
          "type": "array",
          "items": { "type": "string" }
        },
        "reviewers": {
          "type": "array",
          "items": { "type": "string" }
        },
        "tags": {
          "type": "array",
          "items": { "type": "string" }
        },
        "projectUrl": { "type": "string", "format": "uri" },
        "documentUrl": { "type": "string", "format": "uri" }
      }
    }
  }
}
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://req-mindmap.example.com/schemas/mindmap-schema.json",
  "title": "MindmapData",
  "description": "JSON Schema for validating mindmap YAML/JSON files",
  "type": "object",
  "required": ["version", "title", "root"],
  "additionalProperties": false,
  "properties": {
    "version": {
      "type": "string",
      "description": "データ形式のバージョン"
    },
    "title": {
      "type": "string",
      "description": "マインドマップのタイトル"
    },
    "description": {
      "type": "string",
      "description": "マインドマップの説明"
    },
    "metadata": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "createdAt": {
          "type": "string",
          "description": "作成日時"
        },
        "updatedAt": {
          "type": "string",
          "description": "更新日時"
        },
        "description": {
          "type": "string",
          "description": "メタデータの説明"
        }
      },
      "description": "追加のメタデータ"
    },
    "schema": {
      "$ref": "#/definitions/CustomSchema"
    },
    "tags": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/TagDefinition"
      },
      "description": "利用可能なタグの定義"
    },
    "root": {
      "$ref": "#/definitions/MindmapNode"
    }
  },
  "definitions": {
    "MindmapNode": {
      "type": "object",
      "required": ["id", "title"],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "ノードの一意識別子"
        },
        "title": {
          "type": "string",
          "description": "ノードのタイトル"
        },
        "description": {
          "type": "string",
          "description": "ノードの詳細説明"
        },
        "priority": {
          "type": "string",
          "enum": ["critical", "high", "medium", "low"],
          "description": "ノードの優先度"
        },
        "status": {
          "type": "string",
          "enum": ["draft", "pending", "in-progress", "review", "done", "cancelled", "deferred"],
          "description": "ノードのステータス"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "ノードに関連付けられたタグ"
        },
        "customFields": {
          "type": "object",
          "description": "カスタムフィールドの値"
        },
        "children": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/MindmapNode"
          },
          "description": "子ノードの配列"
        }
      }
    },
    "CustomSchema": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "customFields": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/FieldDefinition"
          },
          "description": "カスタムフィールド定義"
        }
      }
    },
    "FieldDefinition": {
      "type": "object",
      "required": ["name", "type", "label"],
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string",
          "description": "フィールド名"
        },
        "type": {
          "type": "string",
          "enum": ["string", "number", "boolean", "date", "select", "multiselect"],
          "description": "フィールドの型"
        },
        "label": {
          "type": "string",
          "description": "表示用ラベル"
        },
        "required": {
          "type": "boolean",
          "description": "必須フィールドかどうか"
        },
        "options": {
          "type": "array",
          "items": { "type": "string" },
          "description": "select/multiselect用の選択肢"
        },
        "description": {
          "type": "string",
          "description": "フィールドの説明"
        }
      }
    },
    "TagDefinition": {
      "type": "object",
      "required": ["name"],
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string",
          "description": "タグ名"
        },
        "color": {
          "type": "string",
          "description": "タグの色"
        },
        "description": {
          "type": "string",
          "description": "タグの説明"
        }
      }
    }
  }
}